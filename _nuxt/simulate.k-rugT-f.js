import{d as F,M as ee,G as te,a as ne,b as se,c as oe,_ as ie,B as R,g as L,I as T,e as le,f as G,h as ae,j as ce}from"./state.8A-Wp3He.js";import{n as j,r as $,s as U,q as H,u as M,v as C,o as d,c as f,a as e,t as y,b as w,w as E,F as I,x as k,z as x,y as l,B as D,C as re,D as de,g as V,A as N,E as J,T as ue,G as pe,_ as me}from"./entry.B_ywYInL.js";const fe={class:"market-header text-center"},he={class:"text-yellow-200 text-7xl"},_e={class:"table-wrapper"},ge=e("div",{class:"grid grid-nogutter table-header"},[e("div",{class:"table-header-content flex align-items-center justify-content-center col-goods"},[e("span",{class:"pi pi-sort-icon-goods"})]),e("div",{class:"table-header-content flex align-items-center justify-content-center col-order"},[e("span",{class:"text-orange-200"},"売り注文")]),e("div",{class:"table-header-content flex align-items-center justify-content-center col-order"},[e("span",{class:"text-orange-200"},"買い注文")]),e("div",{class:"table-header-content flex align-items-center justify-content-center col-balance"},[e("span",{class:"text-white"},"収支")]),e("div",{class:"table-header-content flex align-items-center justify-content-center col-price"},[e("span",{class:"text-orange-200"},"市場価格")])],-1),ve={class:"table-row-content flex align-items-center justify-content-center col-goods"},be={class:"table-row-content flex align-items-center justify-content-end col-order right-border"},ye={class:"text-white mr-2"},xe={class:"table-row-content flex align-items-center justify-content-end col-order right-border"},we={class:"text-white mr-2"},$e={class:"table-row-content flex justify-content-center col-balance right-border"},Ie={class:"table-row-content flex justify-content-center col-price grid grid-nogutter"},Be={class:"col-6 flex flex-wrap align-items-center justify-content-end"},ke={class:"flex flex-wrap align-items-center"},Se=e("span",{class:"pi pi-money s-icon"},null,-1),Te={class:"text-white mr-1"},Me={class:"col-6",style:{height:"100",display:"block"}},Ae=j({__name:"MarketSimulatePanel",props:{title:{},editable:{type:Boolean}},setup(p){const n=p,m=$(0),u=$(),v=F(),{marketArray:_}=U(v),g=i=>{const h=.13636363636363635;for(let s=0;s<12;s++)if(i<=-.75+h*s)return"pi-coin-"+(s+1).toString().padStart(2,"0");return"pi-coin-13"},b=i=>{const h=Math.floor(i*100);return h==0?"0 %":h>0?`+ ${h} %`:`- ${-h} %`},a=i=>ne(i)?"table-industrial-row":se(i)?"table-luxury-row":oe(i)?"table-military-row":"table-staple-row";H(()=>{var h;const i=(h=document.getElementById("main-panel"))==null?void 0:h.getBoundingClientRect().top;m.value=i??0});const c=M(()=>window?{height:`${window.innerHeight-m.value}px`}:void 0);return(i,h)=>{const s=ie,o=C("ScrollPanel");return d(),f("div",{class:"market-panel",ref_key:"panelElem",ref:u},[e("div",fe,[e("span",he,y(n.title),1)]),w(o,{class:"main-panel",id:"main-panel",style:D(l(c))},{default:E(()=>[e("div",_e,[ge,(d(!0),f(I,null,k(l(_),r=>(d(),f("div",{class:x(["grid grid-nogutter table-row",a(r.id)])},[e("div",ve,[e("span",{class:x(["pi",("MarketIconTable"in i?i.MarketIconTable:l(ee))[r.id]])},null,2)]),e("div",be,[e("span",ye,y(r.sell),1)]),e("div",xe,[e("span",we,y(r.buy),1)]),e("div",$e,[w(s,{label:r.balanceLabel,balance:r.balanceRate},null,8,["label","balance"])]),e("div",Ie,[e("div",Be,[e("div",ke,[Se,e("span",Te,y(Math.floor(("GoodsTable"in i?i.GoodsTable:l(te))[r.id].baseCost*(1+r.marketBalanceRate)+.5)),1),e("span",{class:x(["pi xs-icon",g(r.marketBalanceRate)])},null,2)])]),e("div",Me,[w(s,{label:b(r.marketBalanceRate),balance:r.marketBalanceRate/.75*.5},null,8,["label","balance"])])])],2))),256))])]),_:1},8,["style"])],512)}}});function Ce(p){return re()?(de(p),!0):!1}function K(p){return typeof p=="function"?p():l(p)}const Q=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Le=Object.prototype.toString,Ee=p=>Le.call(p)==="[object Object]",q=()=>{},Pe=Re();function Re(){var p,n;return Q&&((p=window==null?void 0:window.navigator)==null?void 0:p.userAgent)&&(/iP(ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function P(p){var n;const m=K(p);return(n=m==null?void 0:m.$el)!=null?n:m}const X=Q?window:void 0;function O(...p){let n,m,u,v;if(typeof p[0]=="string"||Array.isArray(p[0])?([m,u,v]=p,n=X):[n,m,u,v]=p,!n)return q;Array.isArray(m)||(m=[m]),Array.isArray(u)||(u=[u]);const _=[],g=()=>{_.forEach(i=>i()),_.length=0},b=(i,h,s,o)=>(i.addEventListener(h,s,o),()=>i.removeEventListener(h,s,o)),a=V(()=>[P(n),K(v)],([i,h])=>{if(g(),!i)return;const s=Ee(h)?{...h}:h;_.push(...m.flatMap(o=>u.map(r=>b(i,o,r,s))))},{immediate:!0,flush:"post"}),c=()=>{a(),g()};return Ce(c),c}let z=!1;function je(p,n,m={}){const{window:u=X,ignore:v=[],capture:_=!0,detectIframe:g=!1}=m;if(!u)return q;Pe&&!z&&(z=!0,Array.from(u.document.body.children).forEach(s=>s.addEventListener("click",q)),u.document.documentElement.addEventListener("click",q));let b=!0;const a=s=>v.some(o=>{if(typeof o=="string")return Array.from(u.document.querySelectorAll(o)).some(r=>r===s.target||s.composedPath().includes(r));{const r=P(o);return r&&(s.target===r||s.composedPath().includes(r))}}),i=[O(u,"click",s=>{const o=P(p);if(!(!o||o===s.target||s.composedPath().includes(o))){if(s.detail===0&&(b=!a(s)),!b){b=!0;return}n(s)}},{passive:!0,capture:_}),O(u,"pointerdown",s=>{const o=P(p);b=!a(s)&&!!(o&&!s.composedPath().includes(o))},{passive:!0}),g&&O(u,"blur",s=>{setTimeout(()=>{var o;const r=P(p);((o=u.document.activeElement)==null?void 0:o.tagName)==="IFRAME"&&!(r!=null&&r.contains(u.document.activeElement))&&n(s)},0)})].filter(Boolean);return()=>i.forEach(s=>s())}const qe={class:"method-dropdown-wrapper"},Oe={class:"text-white ml-2 mb-1"},Ve=["onClick"],Ge={class:"text-white text-lg mr-2"},He={class:"flex ml-auto"},De={class:"flex align-items-center mr-1"},Ne={class:"text-red-600"},We=e("span",{class:"pi-turns-into mr-1 ml-1"},null,-1),ze={class:"flex align-items-center mr-1"},Fe={class:"text-green-600"},Ue=j({__name:"SimulateMethodOptionList",props:{buildingId:{},methodIndex:{},methodValue:{}},emits:["update"],setup(p,{emit:n}){const m=p,u=n,v=M(()=>R[m.buildingId]),_=M(()=>v.value.methods[m.methodIndex]),g=M(()=>_.value.options),b=o=>le[g.value[o].name],a=$(!1),c=$(),i=$(),h=M(()=>{if(!c.value||!i.value||!a.value)return;const o=i.value.getBoundingClientRect(),r=window.innerHeight,t=c.value.getBoundingClientRect().height;return{top:`${o.top+t>r?r-t:o.top}px`,left:`${o.right}px`}}),s=o=>{u("update",o),a.value=!1};return je(c,o=>{o.stopPropagation(),a.value=!1}),(o,r)=>(d(),f(I,null,[e("div",qe,[e("div",{ref_key:"buttonRef",ref:i,class:"method-icon-wrapper",onClick:r[0]||(r[0]=t=>a.value=!l(a))},[e("span",{class:x(["pi",b(m.methodValue)])},null,2)],512)]),(d(),N(ue,{to:"body"},[l(a)?(d(),f("div",{key:0,ref_key:"dropdownRef",ref:c,class:"flex flex-column method-dropdown-list",style:D(l(h))},[e("span",Oe,y(l(_).display),1),(d(!0),f(I,null,k(l(g),(t,B)=>(d(),f("div",{class:x(["method-button flex align-items-center",m.methodValue==B?"method-focus":""]),onClick:S=>s(B)},[e("span",{class:x(["pi",b(B)])},null,2),e("span",Ge,y(t.display),1),e("div",He,[(d(!0),f(I,null,k(("getAmountList"in o?o.getAmountList:l(L))(t.requires),S=>(d(),f("div",De,[e("span",{class:x(["pi s-icon",("IconTable"in o?o.IconTable:l(T))[S[0]]])},null,2),e("span",Ne,y(S[1]),1)]))),256)),We,(d(!0),f(I,null,k(("getAmountList"in o?o.getAmountList:l(L))(t.produces),S=>(d(),f("div",ze,[e("span",{class:x(["pi s-icon",("IconTable"in o?o.IconTable:l(T))[S[0]]])},null,2),e("span",Fe,y(S[1]),1)]))),256))])],10,Ve))),256))],4)):J("",!0)]))],64))}}),Je={class:"flex flex-column method-wrapper"},Ke={class:"method-header flex align-items-center justify-content-between"},Qe={class:"text-yellow-200 text-lg"},Xe={class:"flex method-panel"},Ye={class:"op-panel mr-1 flex align-items-center"},Ze={class:"flex"},et={class:"ml-1 mr-1"},tt={class:"ml-auto flex align-items-center"},nt=e("span",{class:"text-white mr-1"},"生産補正",-1),st=e("span",{class:"text-white ml-1"},"%",-1),ot={class:"flex flex-wrap mt-2"},it={class:"flex align-items-center mr-1"},lt={class:"text-red-600"},at=e("span",{class:"pi-turns-into mr-1 ml-1"},null,-1),ct={class:"flex align-items-center mr-1"},rt={class:"text-green-600"},dt=j({__name:"SimulateExpandedItem",props:{id:{},index:{},method:{},requires:{},produces:{}},setup(p){const n=p,m=$(),u=$(),v=G(),_=$(n.method.amount.toString()),g=$(n.method.modifier.toString()),b=()=>{m.value&&(m.value.value=_.value),u.value&&(u.value.value=g.value)},a=()=>{const t=n.method.amount+1;t>9999||(_.value=t.toString(),v.updateAmount(n.id,n.index,t))},c=()=>{const t=n.method.amount-1;t<0||(_.value=t.toString(),v.updateAmount(n.id,n.index,t))},i=()=>{v.removeMethod(n.id,n.index)};H(()=>{b()}),V(()=>n.method.amount,t=>{_.value=t.toString(),b()}),V(()=>n.method.modifier,t=>{g.value=t.toString(),b()});const h=t=>{if(!(t.target instanceof HTMLInputElement))return;const B=t.target.value;(B===""||/^\d+$/.test(B))&&(_.value=B),b()},s=t=>{if(!(t.target instanceof HTMLInputElement))return;const B=t.target.value;(B===""||/^\d+$/.test(B))&&(g.value=B),b()},o=()=>{const t=_.value.trim()===""?0:parseInt(_.value,10);_.value=t.toString(),v.updateAmount(n.id,n.index,t)},r=()=>{const t=g.value.trim()===""?0:parseInt(g.value,10);g.value=t.toString(),v.updateModifier(n.id,n.index,t)};return(t,B)=>{const S=C("Button"),Y=Ue;return d(),f("div",Je,[e("div",Ke,[e("span",Qe,y(("BuildingsTable"in t?t.BuildingsTable:l(R))[n.id].display+"_"+n.index),1),w(S,{icon:"pi pi-minus-button",text:"",rounded:"",onClick:i})]),e("div",Xe,[e("div",Ye,[w(S,{icon:"pi pi-minus-button",text:"",rounded:"",onClick:c}),e("input",{ref_key:"inputAmountRef",ref:m,onInput:h,onBlur:o,maxlength:"4",class:"amount-form text-white"},null,544),w(S,{icon:"pi pi-plus-button",text:"",rounded:"",onClick:a})]),e("div",Ze,[(d(!0),f(I,null,k(n.method.methods,(A,W)=>(d(),f("div",et,[w(Y,{buildingId:n.id,methodIndex:W,methodValue:A,onUpdate:Z=>l(v).updateMethod(n.id,n.index,W,Z)},null,8,["buildingId","methodIndex","methodValue","onUpdate"])]))),256))]),e("div",tt,[nt,e("input",{ref_key:"inputModifierRef",ref:u,onInput:s,onBlur:r,maxlength:"4",class:"modifier-form text-white"},null,544),st])]),e("div",ot,[(d(!0),f(I,null,k(("getAmountList"in t?t.getAmountList:l(L))(t.requires),A=>(d(),f("div",it,[e("span",{class:x(["pi s-icon",("IconTable"in t?t.IconTable:l(T))[A[0]]])},null,2),e("span",lt,y(A[1]),1)]))),256)),at,(d(!0),f(I,null,k(("getAmountList"in t?t.getAmountList:l(L))(t.produces),A=>(d(),f("div",ct,[e("span",{class:x(["pi s-icon",("IconTable"in t?t.IconTable:l(T))[A[0]]])},null,2),e("span",rt,y(A[1]),1)]))),256))])])}}}),ut={class:"flex flex-nowrap building-item"},pt={class:"icon-panel"},mt={class:"building-detail flex flex-column"},ft={class:"building-display flex align-items-center"},ht={class:"text-white text-xl display-content"},_t={class:"ml-auto flex align-items-center"},gt=e("span",{class:"pi pi-money s-icon display-content"},null,-1),vt={class:"text-red-600 display-content"},bt=e("span",{class:"pi-turns-into display-content mr-1 ml-1"},null,-1),yt=e("span",{class:"pi pi-money s-icon display-content"},null,-1),xt={class:"text-green-600 display-content"},wt={class:"flex flex-wrap mt-2"},$t={class:"flex align-items-center mr-1"},It={class:"text-red-600"},Bt=e("span",{class:"pi-turns-into mr-1 ml-1"},null,-1),kt={class:"flex align-items-center mr-1"},St={class:"text-green-600"},Tt={key:0,class:"flex flex-column expand-panel"},Mt={class:"flex justify-content-center pt-3 pb-3"},At=j({__name:"SimulateBuildingItem",props:{id:{},methods:{},requires:{},produces:{}},setup(p){const n=p,m=G(),u=F(),v=$(!1),_=()=>{v.value=!1,m.removeBuilding(n.id)},g=M(()=>Object.entries(n.requires).reduce((a,[c,i])=>a+(u.marketCost[c]??0)*i,0)),b=M(()=>Object.entries(n.produces).reduce((a,[c,i])=>a+(u.marketCost[c]??0)*i,0));return(a,c)=>{const i=C("Button"),h=dt;return d(),f(I,null,[e("div",ut,[e("div",pt,[e("span",{class:x(["pi l-icon",("IconTable"in a?a.IconTable:l(T))[n.id]])},null,2)]),e("div",mt,[e("div",ft,[e("span",{class:x(["pi expand-button display-content",l(v)?"pi-expand-arrow-expanded":"pi-expand-arrow"]),onClick:c[0]||(c[0]=s=>v.value=!l(v))},null,2),e("span",ht,y(("BuildingsTable"in a?a.BuildingsTable:l(R))[n.id].display),1),e("div",_t,[gt,e("span",vt,y(l(g)),1),bt,yt,e("span",xt,y(l(b)),1),w(i,{icon:"pi pi-minus-s-button display-content",text:"",rounded:"",onClick:_})])]),e("div",wt,[(d(!0),f(I,null,k(("getAmountList"in a?a.getAmountList:l(L))(a.requires),s=>(d(),f("div",$t,[e("span",{class:x(["pi s-icon",("IconTable"in a?a.IconTable:l(T))[s[0]]])},null,2),e("span",It,y(s[1]),1)]))),256)),Bt,(d(!0),f(I,null,k(("getAmountList"in a?a.getAmountList:l(L))(a.produces),s=>(d(),f("div",kt,[e("span",{class:x(["pi s-icon",("IconTable"in a?a.IconTable:l(T))[s[0]]])},null,2),e("span",St,y(s[1]),1)]))),256))])])]),l(v)?(d(),f("div",Tt,[(d(!0),f(I,null,k(n.methods.methods,(s,o)=>(d(),N(h,{id:n.id,index:o,method:s,requires:("MethodRequires"in a?a.MethodRequires:l(ae))(n.id,s),produces:("MethodProduces"in a?a.MethodProduces:l(ce))(n.id,s)},null,8,["id","index","method","requires","produces"]))),256)),e("div",Mt,[w(i,{class:"plus-button",icon:"pi pi-plus-button",text:"",rounded:"",onClick:c[1]||(c[1]=s=>l(m).addMethod(n.id))})])])):J("",!0)],64)}}}),Ct=e("div",{class:"simulate-header text-center"},[e("span",{class:"text-white text-7xl"},"施設")],-1),Lt={class:"flex add-building align-items-center justify-content-center"},Et={key:0,class:"flex align-items-center"},Pt={class:"option-label text-white"},Rt={key:1,class:"text-gray-500"},jt={class:"flex align-items-center dropdown-item",style:{width:"100%"}},qt={class:"option-label text-white"},Ot=e("span",{class:"text-white"},"No Buildings",-1),Vt=j({__name:"SimulateBuildingsPanel",setup(p){const n=$(0),m=$(),u=G(),{listArray:v,deactiveBuildings:_}=U(u),g=$(_.value[0]),b=()=>{g.value&&(u.activateBuilding(g.value),g.value=_.value[0])};H(()=>{var i;const c=(i=document.getElementById("main-panel"))==null?void 0:i.getBoundingClientRect().top;n.value=c??0});const a=M(()=>window?{height:`${window.innerHeight-n.value}px`}:void 0);return(c,i)=>{const h=C("Button"),s=C("Dropdown"),o=At,r=C("ScrollPanel");return d(),f("div",{class:"simulate-panel",ref_key:"panelElem",ref:m},[Ct,w(r,{class:"main-panel",id:"main-panel",style:D(l(a))},{default:E(()=>[e("div",Lt,[w(h,{class:"plus-button",icon:"pi pi-plus-button",text:"",rounded:"",onClick:b}),w(s,{class:"select-building","panel-class":"dropdown-panel",modelValue:l(g),"onUpdate:modelValue":i[0]||(i[0]=t=>pe(g)?g.value=t:null),options:l(_),placeholder:"Select a Building"},{value:E(t=>[t.value?(d(),f("div",Et,[e("span",{class:x(["pi s-icon",("IconTable"in c?c.IconTable:l(T))[t.value]])},null,2),e("span",Pt,y(("BuildingsTable"in c?c.BuildingsTable:l(R))[t.value].display),1)])):(d(),f("span",Rt,y(t.placeholder),1))]),option:E(t=>[e("div",jt,[e("span",{class:x(["pi s-icon",("IconTable"in c?c.IconTable:l(T))[t.option]])},null,2),e("span",qt,y(("BuildingsTable"in c?c.BuildingsTable:l(R))[t.option].display),1)])]),empty:E(()=>[Ot]),_:1},8,["modelValue","options"])]),(d(!0),f(I,null,k(l(v),t=>(d(),N(o,{id:t.id,methods:t.item,requires:t.requires,produces:t.produces},null,8,["id","methods","requires","produces"]))),256))]),_:1},8,["style"])],512)}}}),Gt={},Ht={class:"flex flex-nowrap"};function Dt(p,n){const m=Ae,u=Vt;return d(),f("div",Ht,[w(m,{title:"市場予測"}),w(u)])}const zt=me(Gt,[["render",Dt]]);export{zt as default};
